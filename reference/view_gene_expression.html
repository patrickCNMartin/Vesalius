<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>view_gene_expression — view_gene_expression • vesalius</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="view_gene_expression — view_gene_expression"><meta property="og:description" content="View gene expression in spatial omics data, in specific territories or
the expression of genes in a subset of cells."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vesalius</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/vesalius.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Vesalius_Analysis/Spatial_DNA_seq.html">Vesalius: Spatial Genomics</a>
    </li>
    <li>
      <a href="../articles/Vesalius_Analysis/Spatial_RNA_seq.html">Vesalius: Spatial Transcriptomics</a>
    </li>
    <li>
      <a href="../articles/Vesalius_Analysis/Vesalius_MSB_analysis.html">Vesalius: MSB Manuscript Analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/patrickCNMartin/Vesalius/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>view_gene_expression</h1>
    <small class="dont-index">Source: <a href="https://github.com/patrickCNMartin/Vesalius/blob/main/R/visualization.R" class="external-link"><code>R/visualization.R</code></a></small>
    <div class="hidden name"><code>view_gene_expression.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>View gene expression in spatial omics data, in specific territories or
the expression of genes in a subset of cells.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">view_gene_expression</span><span class="op">(</span></span>
<span>  <span class="va">vesalius_assay</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm_method <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  trial <span class="op">=</span> <span class="st">"last"</span>,</span>
<span>  territory_1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  territory_2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cells <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  norm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  as_layer <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  with_background <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cex <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  cex_pt <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  max_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  return_as_list <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>vesalius_assay</dt>
<dd><p>a vesalius_assay object</p></dd>


<dt>genes</dt>
<dd><p>character vector containing the genes you wish to 
visualise.</p></dd>


<dt>norm_method</dt>
<dd><p>character string - which count matrix should be used.</p></dd>


<dt>trial</dt>
<dd><p>character string describing which segmentation trial
to use. Default is "last" which is the last trial used.</p></dd>


<dt>territory_1</dt>
<dd><p>integer or vector of integers descrbing territories in
group 1 (see details)</p></dd>


<dt>territory_2</dt>
<dd><p>integer or vector of integers descrbing territories in
group 2 (see details)</p></dd>


<dt>cells</dt>
<dd><p>charactor vector containing barcodes/spatial_indices
associated with cell types of interest (see details)</p></dd>


<dt>norm</dt>
<dd><p>logical indicating if expression should be min/max normalised</p></dd>


<dt>as_layer</dt>
<dd><p>logical indicating if expression should represented as
a territory/ layer.</p></dd>


<dt>cex</dt>
<dd><p>numeric - font size modulator</p></dd>


<dt>cex_pt</dt>
<dd><p>numeric point size</p></dd>


<dt>alpha</dt>
<dd><p>point transparency</p></dd>


<dt>return_as_list</dt>
<dd><p>logical - should plot be returned as simple list
or as a ggplot object (single gene)/ patchwork object (multiple genes)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a ggplot object</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Vesalius offers a plotting function that allows you to 
visualise gene expression.</p>
<p>This function offers multiple options depending on what you provide.</p>
<p>1. Overall expression
You can visualise the overall expression pattern of a set of genes
by providing a vesalius_assay object containing counts.
If <code>as_layer</code> is set to FALSE this will show the expression at
each sptial index indivdually. If set to TRUE, this will show the
average expression on a gene in all territories present.</p>
<p>2. Expression in a territory
You can visualise the expression of a gene in an isolated territory.</p>
<p>3. Expression of cells in one or more territory
If you want to visualise the expression of specific cells, you can
parse a character vector containing your cells of interest. This
function will automatically subset the relevant territory data and
show the expression only in the spatial indeces hat are associated
with your cell type of interest. You can use this option to contrast
the expression of cells between territories by also providing which
territories you wish to contrast (`territory_1` and `territory_2`).
If only a single territory is provided, vesalius will only shows cell
in that territory.</p>
<p>If you provide more than one gene, `view_gene_expression` will return 
a ggarrange list containing all your genes as individual plots.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vesalius</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># First we build a simple object</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu">build_vesalius_object</span><span class="op">(</span><span class="va">coordinates</span>, <span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># We can do a simple run</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu">build_vesalius_embeddings</span><span class="op">(</span><span class="va">ves</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simple smoothing</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu"><a href="smooth_image.html">smooth_image</a></span><span class="op">(</span><span class="va">ves</span>, dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># quick segmentation</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu"><a href="segment_image.html">segment_image</a></span><span class="op">(</span><span class="va">ves</span>, dimensions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># isolate territories</span></span></span>
<span class="r-in"><span><span class="va">ves</span> <span class="op">&lt;-</span> <span class="fu"><a href="isolate_territories.html">isolate_territories</a></span><span class="op">(</span><span class="va">ves</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view over all expression</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>, genes <span class="op">=</span> <span class="st">"Malat1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>, genes <span class="op">=</span> <span class="st">"Malat1"</span>, as_layer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view expression in isolated territory </span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>, genes <span class="op">=</span> <span class="st">"Malat1"</span>, territory_1 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view expression of cells</span></span></span>
<span class="r-in"><span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu"><a href="get_counts.html">get_counts</a></span><span class="op">(</span><span class="va">ves</span><span class="op">)</span><span class="op">)</span>,<span class="fl">300</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">view_gene_expression</span><span class="op">(</span><span class="va">ves</span>,</span></span>
<span class="r-in"><span> genes <span class="op">=</span> <span class="st">"Malat"</span>,</span></span>
<span class="r-in"><span> cells <span class="op">=</span> <span class="va">cells</span>,</span></span>
<span class="r-in"><span> territory_1 <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span> terriotry_2 <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick C.N. Martin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

